{% extends 'bases/base.html' %}
{% load static %}

{% block content %}
<div class="d-flex align-items-stretch center">
    <div class="card-exit">
        <a class="card-exit__pencil" href="/profile-settings/">
            <i class="fa fa-pencil-square-o card-exit__fa-pencil" aria-hidden="true"></i>
        </a>
        <a class="card-exit__times" href="/">
            <i class="fa fa-times card-exit__fa-times" aria-hidden="true"></i>
        </a>
    </div>
    <div class="profile-container">
        <div class="row no-gutters">
            <div class="avatar">
                <div class="avatar-exit">
                    <a class="avatar-exit__pencil" href="/profile-settings/">
                        <i class="fa fa-pencil-square-o avatar-exit__fa-pencil" aria-hidden="true"></i>
                    </a>
                    <a class="avatar-exit__times" href="/">
                        <i class="fa fa-times avatar-exit__fa-times" aria-hidden="true"></i>
                    </a>
                </div>
                <div class="avatar__upload">
                    <i class="fa fa-camera avatar_camera" aria-hidden="true"></i>
                </div>
                <img class="d-lg-flex justify-content-lg-center avatar__img" src="{% static 'avatar1.jpg' %}">
                <div class="avatar__icons">
                    <div class="avatar__stars">
                        <i class="fa fa-star avatar__star" aria-hidden="true"></i>
                        <i class="fa fa-star avatar__star" aria-hidden="true"></i>
                        <i class="fa fa-star avatar__star" aria-hidden="true"></i>
                        <i class="fa fa-star-o avatar__star" aria-hidden="true"></i>
                        <i class="fa fa-star-o avatar__star" aria-hidden="true"></i>
                    </div>
                    <div class="avatar__likes">
                        <i class="fa fa-thumbs-o-up avatar__like" aria-hidden="true"></i> 40
                    </div>
                    <div class="avatar__dislikes">
                        <i class="fa fa-thumbs-o-down avatar__dislike" aria-hidden="true"></i> 8
                    </div>
                </div>
            </div>
            <div class="col-sm-6 info">
                <div class="row">
                    <div class="col-sm info__sm">
                        <h4 class="info__username">{{item.name}}</h4>
                    </div>
                    <div class="col-sm">
                        <div class="container info__networks">
                            <i class="fa fa-map-marker info__gold-color" aria-hidden="true"></i>
                            {% if item.location %}
                            <nobr> {{item.location}}</nobr>
                            {% else %}
                            <nobr>Location</nobr>
                            {% endif %}
                            <br>
                            <i class="fa fa-envelope info__gold-color" aria-hidden="true"></i>
                            {% if item.email %}
                            <nobr> {{item.email}}</nobr>
                            {% else %}
                            <nobr>Email</nobr>
                            {% endif %}
                            <br><br>
                            {% if item.Vk %}
                            <a href="{{ item.Vk }}" class="fa fa-vk info__network" aria-hidden="true"></a>
                            {%endif%}

                            {%if item.instagram%}
                            <a href="{{ item.instagram }}" class="fa fa-instagram info__network" aria-hidden="true"></a>
                            {%endif%}

                            {%if item.facebook%}
                            <a href="{{ item.facebook }}" class="fa fa-facebook info__network" aria-hidden="true"></a>
                            {%endif%}

                            {%if item.twitter%}
                            <a href="{{ item.twitter }}" class="fa fa-twitter info__network" aria-hidden="true"></a>
                            {%endif%}

                            {%if item.odnoklassniki%}
                            <a href="{{ item.odnoklassniki }}" class="fa fa-odnoklassniki info__network"
                               aria-hidden="true"></a>
                            {%endif%}

                            {%if item.youtube_play%}
                            <a href="{{ item.youtube_play }}" class="fa fa-youtube-play info__network"
                               aria-hidden="true"></a>
                            {%endif%}

                        </div>
                    </div>
                    <div class="col-sm-12 info__card-aboutme">
                        <h4 class="info__aboutme">About me:</h4>
                        <br>
                        <div class="container info__text">
                            <p>{{item.quotes}}</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-12 tab">
                <div class="row">
                    <div class="col-sm-6 tab__text">
                        <nobr class="tab__last-stream">LAST STREAMS</nobr>
                    </div>
                    <div class="col-sm-6 tab__btn">
                        <a id="fame-text" href="#fame" class="tab__a tab__a-border">FAME LEVEL</a>
                        <a id="view-text" href="#view" class="tab__a">VIEWS</a>
                    </div>
                </div>
            </div>
            <div class="col-sm-12">
                <div class="row slider-row">
                    <div class="container mobile">
                        <nobr class="tab__last-stream">LAST STREAMS</nobr>
                    </div>
                    <div class="col-sm-6 slider">
                        <div class="container slider__size">
                            <div id="carouselExampleCaptions" class="carousel slide" data-ride="carousel">
                                <ol class="carousel-indicators">
                                    <li data-target="#carouselExampleCaptions" data-slide-to="0" class="active"></li>
                                    <li data-target="#carouselExampleCaptions" data-slide-to="1"></li>
                                    <li data-target="#carouselExampleCaptions" data-slide-to="2"></li>
                                </ol>
                                <div class="carousel-inner">
                                    <div class="carousel-item active">
                                        <img src="https://avatars.mds.yandex.net/get-pdb/404799/22dc4942-a3a1-42d9-af31-d9c186980042/s1200"
                                             class="d-block w-100 slider__photo" alt="...">
                                        <div class="carousel-caption d-none d-md-block">
                                            <h5>Stream name</h5>
                                            <p>date of stream</p>
                                        </div>
                                    </div>
                                    <div class="carousel-item">
                                        <img src="https://pbs.twimg.com/media/EApge7FXUAI6KNA.jpg:large"
                                             class="d-block w-100 slider__photo" alt="...">
                                        <div class="carousel-caption d-none d-md-block">
                                            <h5>Stream name</h5>
                                            <p>date of stream</p>
                                        </div>
                                    </div>
                                    <div class="carousel-item">
                                        <img src="https://c.pxhere.com/photos/0a/37/canon_l_f2_usm_ef_135mm-146680.jpg!d"
                                             class="d-block w-100 slider__photo" alt="...">
                                        <div class="carousel-caption d-none d-md-block">
                                            <h5>Stream name</h5>
                                            <p>date of stream</p>
                                        </div>
                                    </div>
                                </div>
                                <a class="carousel-control-prev" href="#carouselExampleCaptions" role="button"
                                   data-slide="prev">
                                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                    <span class="sr-only">Previous</span>
                                </a>
                                <a class="carousel-control-next" href="#carouselExampleCaptions" role="button"
                                   data-slide="next">
                                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                    <span class="sr-only">Next</span>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="container mobile">
                        <a id="mfame-text" href="#fame" class="tab__a tab__a-border">FAME LEVEL</a>
                        <a id="mview-text" href="#view" class="tab__a">VIEWS</a>
                    </div>
                    <div id="chart" class="col-sm-6 chart">
                        <div id="fame" class="conteiner show chart__size">
                            <canvas id="lineCahrt" width="400" height="300" class="chart__js chart__size"></canvas>
                        </div>
                        <div id="view" class="hide container progress__size">
                            <h4 class="progress__views">397 Views</h4>
                            <h5 class="nowrap"><i class="fa fa-thumbs-o-up progress__like" aria-hidden="true"></i>
                                Likes</h5>
                            <div class="progress">
                                {% if likes_count != None %}
                                    <div class="progress-bar bg-success" role="progressbar" style="width: {{ likes_count }}%;"
                                         aria-valuenow="{{ likes_count }}" aria-valuemin="0" aria-valuemax="100">{{ likes_count }}
                                    </div>
                                {% else %}
                                    <div class="progress-bar bg-success" role="progressbar" style="width: 0%;"
                                         aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0
                                    </div>
                                {% endif %}
                            </div>
                            <h5 class="nowrap"><i class="fa fa-thumbs-o-down progress__dislike" aria-hidden="true"
                            ></i> Dislikes</h5>
                            <div class="progress">
                                {% if dislikes_count != None %}
                                    <div class="progress-bar bg-danger" role="progressbar" style="width: {{ dislikes_count }}%"
                                         aria-valuenow="{{ dislikes_count }}" aria-valuemin="0" aria-valuemax="100">{{ dislikes_count }}
                                    </div>
                                {% else %}
                                    <div class="progress-bar bg-danger" role="progressbar" style="width: 0%"
                                         aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0
                                    </div>
                                {% endif %}
                            </div>

                            <h5 class="nowrap"><i class="fa fa-paper-plane-o progress__share" aria-hidden="true"></i>
                                Share</h5>
                            <div class="progress">
                                <div class="progress-bar progress__share-bg" role="progressbar" style="width: 67%"
                                     aria-valuenow="67" aria-valuemin="0" aria-valuemax="100">67
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="https://d19m59y37dris4.cloudfront.net/dark-admin/1-4-5/vendor/chart.js/Chart.min.js"></script>
<script>
    var username = document.getElementsByClassName('info__username')[0].textContent;
    var endpoint = '/charts_data_' + username + '/';
    var labels = [];
    var likes = [];
    var dislikes = [];
    $.ajax({
        method: "GET",
        url: endpoint,
        success: (data) => {
            console.log(data);
            labels = data.labels;
            likes = data.likes;
            dislikes = data.dislikes;
            setChart();
        },
        error: (error_data) => {
            console.log('error');
            console.log(error_data);
        }
    });

function setChart() {
    var ctx = document.getElementById('lineCahrt');
    new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [
                {
                    label: "Likes",
                    fill: false,
                    backgroundColor: "#1e7e34",
                    borderColor: "#1e7e34",
                    data: likes
                },
                {
                    label: "Dislikes",
                    fill: false,
                    backgroundColor: "#bd2130",
                    borderColor: "#bd2130",
                    data: dislikes,
                },
            ]
        },
        options: {
            tooltips: {
                mode: 'index',
                intersect: false,
            },
            hover: {
                mode: 'nearest',
                intersect: true
            },
            scales: {
                xAxes: [{
                    display: true,
                    scaleLabel: {
                        display: true,
                        labelString: 'Stream name'
                    }
                }],
                yAxes: [{
                    display: true,
                    scaleLabel: {
                        display: true,
                        labelString: 'Value'
                    }
                }]
            }
        }
    });
}

</script>
{% endblock %}